library(lme4)
dat=read.csv("vulnerability_covariates.csv")
primary_dir=paste("C:/Users/jennm/Dropbox/PROJECTS/SocioEcological_Vulnerability_of_Caribbean/SEV_IndexGLM",sep="")
setwd(primary_dir)
dat=read.csv("vulnerability_covariates.csv")
dat=read.csv("vulnerability_covariates.csv")
dat=read.csv("vulnerability_covariates.csv")
primary_dir=paste("C:/Users/jennm/Dropbox/PROJECTS/SocioEcological_Vulnerability_of_Caribbean/SEV_IndexGLM",sep="")
setwd(primary_dir)
dat=read.csv("vulnerability_covariates.csv")
primary_dir
setwd("C:/Users/jennm/Dropbox/PROJECTS/SocioEcological_Vulnerability_of_Caribbean/Caribbean_Climate_Vulnerability_Analyses_RStudio")
primary_dir=paste("C:/Users/jennm/Dropbox/PROJECTS/SocioEcological_Vulnerability_of_Caribbean/Caribbean_Climate_Vulnerability_Analyses_RStudio",sep="")
setwd(primary_dir)
primary_dir=paste("C:/Users/jennm/Dropbox/PROJECTS/SocioEcological_Vulnerability_of_Caribbean/Caribbean_Climate_Vulnerability_Analyses_RStudio",sep="")
setwd(primary_dir)
C:/Users/jennm/Dropbox/PROJECTS/SocioEcological_Vulnerability_of_Caribbean/Caribbean_Climate_Vulnerability_Analyses_RStudio
primary_dir
primary_dir=paste("C:/Users/jennm/Dropbox/PROJECTS/SocioEcological_Vulnerability_of_Caribbean/Caribbean_Climate_Vulnerability_Analyses_RStudio/",sep="")
setwd(primary_dir)
getwd()
library(dplyr)
library(lme4)
dat=read.csv("vulnerability_covariates.csv")
primary_dir=paste("C:/Users/jennm/Dropbox/PROJECTS/SocioEcological_Vulnerability_of_Caribbean/Caribbean_Climate_Vulnerability_Analyses_RStudio",sep="")
setwd(primary_dir)
setwd("C:/Users/jennm/Dropbox/PROJECTS/SocioEcological_Vulnerability_of_Caribbean/Caribbean_Climate_Vulnerability_Analyses_RStudio")
primary_dir=paste("C:/Users/jennm/Dropbox/PROJECTS/SocioEcological_Vulnerability_of_Caribbean/Caribbean_Climate_Vulnerability_Analyses_RStudio")
setwd(primary_dir)
knitr::opts_chunk$set(echo = TRUE)
opts_chunk$set(root.dir = "C:/Users/jennm/Dropbox/PROJECTS/SocioEcological_Vulnerability_of_Caribbean/Caribbean_Climate_Vulnerability_Analyses_RStudio")
knitr::opts_chunk$set(echo = TRUE)
opts_chunk$set(root.dir = 'C:/Users/jennm/Dropbox/PROJECTS/SocioEcological_Vulnerability_of_Caribbean/Caribbean_Climate_Vulnerability_Analyses_RStudio')
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(root.dir = 'C:/Users/jennm/Dropbox/PROJECTS/SocioEcological_Vulnerability_of_Caribbean/Caribbean_Climate_Vulnerability_Analyses_RStudio')
dat=read.csv("vulnerability_covariates.csv")
ls()
list.files
list.files()
getwd()
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(root.dir = 'C:/Users/jennm/Dropbox/PROJECTS/SocioEcological_Vulnerability_of_Caribbean/Caribbean_Climate_Vulnerability_Analyses_RStudio')
library(dplyr)
library(lme4)
getwd()
dat=read.csv("")
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(root.dir = 'C:/Users/jennm/Dropbox/PROJECTS/SocioEcological_Vulnerability_of_Caribbean/Caribbean_Climate_Vulnerability_Analyses_RStudio')
getwd()
dat=read.csv("")
setwd("C:/Users/jennm/Dropbox/PROJECTS/SocioEcological_Vulnerability_of_Caribbean/Caribbean_Climate_Vulnerability_Analyses_RStudio")
dat=read.csv("")
list.files
list.files()
setwd("C:/Users/jennm/Dropbox/PROJECTS/SocioEcological_Vulnerability_of_Caribbean/Caribbean_Climate_Vulnerability_Analyses_RStudio")
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = '/tmp')
# knitr::opts_chunk$set(root.dir = 'C:/Users/jennm/Dropbox/PROJECTS/SocioEcological_Vulnerability_of_Caribbean/Caribbean_Climate_Vulnerability_Analyses_RStudio')
getwd()
knitr::opts_chunk$set(echo = TRUE)
summary(dat)
dat=read.csv("vulnerability_covariates.csv")
summary(dat)
head(dat_tf)
dat_select<-dat %>%
na.omit()%>%
dplyr::select(eco_sens,eez_percent_prot,coral_percent_prot,fish_reg_total,wgi_score)
summary(dat$eco_exp)
dat=read.csv("vulnerability_covariates.csv")
library(dplyr)
library(dplyr)
library(MASS)
library(car)
library(modEvA)
head(dat_tf)
dat_select<-dat %>%
na.omit()%>%
dplyr::select(eco_sens,eez_percent_prot,coral_percent_prot,fish_reg_total,wgi_score)
summary(dat$eco_exp)
null=glm(eco_sens~1,data=dat_select,family=gaussian(link="identity"))
gaussian=glm(eco_sens ~ .,data=dat_select,family=gaussian(link="identity"))# Model with all Xs included
gaussian$deviance # this is the explained deviance
RsqGLM(gaussian) #This is an approximation for an Rsqard
plot(gaussian) #all Xs included
plot(gaussian) #all Xs included
summary(gaussian) #all Xs included
anova(null,gaussian,test = "Chisq")  # an increase in deviance means a, a non-significant pvalue is a non-significant model
pchisq(0.057259,gaussian$df.residual,lower.tail = FALSE)
drop1(gaussian)
LowestAIC=glm(eco_sens~coral_percent_prot+fish_reg_total+wgi_score,data=dat_select,family=gaussian(link="identity"))
LowestAIC$deviance # this is the explained deviance
RsqGLM(LowestAIC) #This is an approximation for an Rsqard
plot(LowestAIC) #plots for lowest AIC model
summary(LowestAIC) #summary of lowest AIC model
drop1(LowestAIC) # just a check to make sure you shouldn't remove any more
anova(null,gaussian,LowestAIC,test = "Chisq")  # an increase in deviance means a, a non-significant pvalue is a non-significant model
LowestAIC=glm(eco_sens~coral_percent_prot+fish_reg_total+wgi_score,data=dat_select,family=gaussian(link="identity"))
summary(LowestAIC) #summary of lowest AIC model
drop1(LowestAIC) # just a check to make sure you shouldn't remove any more
QB=glm(eco_sens ~ .,data=dat_select,family=quasibinomial)# Model with all Xs included
summary(QB) #all Xs
anova(null,gaussian,LowestAIC,QB,test = "Chisq")  # an increase in deviance means a non-significant model, a high pvalue is a non-significant model
pchisq(0.37664,QB$df.residual,lower.tail = FALSE)
drop1(QB)
QB_best=glm(eco_sens~ coral_percent_prot+wgi_score+fish_reg_total,data=dat_select,family=quasibinomial)
QB_best$deviance # this is the explained deviance
RsqGLM(QB_best) #This is an approximation for an Rsqard
cr.plots(QB_best) #all Xs included
summary(QB_best) #all Xs included
pchisq(QB_best$deviance,QB_best$df.residual,lower.tail = FALSE)
gaussian_best
anova(null,gaussian,LowestAIC,test = "Chisq")  # an increase in deviance means a, a non-significant pvalue is a non-significant model
anova(null,gaussian,gaussian_best,test = "Chisq")  # an increase in deviance means a, a non-significant pvalue is a non-significant model
gaussian_best=glm(eco_sens~coral_percent_prot+fish_reg_total+wgi_score,data=dat_select,family=gaussian(link="identity"))
gaussian_best$deviance # this is the explained deviance
RsqGLM(gaussian_best) #This is an approximation for an Rsqard
plot(gaussian_best) #plots for lowest AIC model
plot(gaussian_best) #plots for lowest AIC model
gaussian_best$deviance # this is the explained deviance
summary(gaussian_best) #summary of lowest AIC model
drop1(gaussian_best) # just a check to make sure you shouldn't remove any more
anova(null,gaussian,gaussian_best,test = "Chisq")  # an increase in deviance means a, a non-significant pvalue is a non-significant model
pchisq(LowestAIC$deviance,LowestAIC$df.residual,lower.tail = FALSE)
summary(gaussian_best) #summary of lowest AIC model
pchisq(0.073947,gaussian_best$df.residual,lower.tail = FALSE)
anova(null,gaussian,gaussian_best,QB,QB_best,test = "Chisq") # an increase in deviance means a non-significant model, a high pvalue is a non-significant model
BetaGLM <- betareg(eco_sens ~ .,data=dat_select)
install.packages("betareg")
library(betareg)
BetaGLM <- betareg(eco_sens ~ .,data=dat_select)
RsqGLM(BetaGLM) #This is an approximation for an Rsqard
plot(BetaGLM) #all Xs included
summary(BetaGLM) #all Xs
anova(null,gaussian,LowestAIC,QB,QB_best,BetaGLM,test = "Chisq")  # an increase in deviance means a non-significant model, a high pvalue is a non-significant model
summary(BetaGLM) #all Xs
drop1(BetaGLM)
drop1(BetaGLM)
step(BetaGLM)
stepAIC(BetaGLM)
install.packages("gamlss")
library(gamlss)
stepGAIC(BetaGLM)
stepGAIC(BetaGLM,direction = "backward")
stepGAIC(BetaGLM,direction = "backward",arg="mean")
stepGAIC(BetaGLM,direction = "backward",additive=TRUE)
AIC(BetaGLM)
summary(BetaGLM) #all Xs
anova(BetaGLM)
ANOVA(betareg())
anova(BetaGLM,type="II")
anova(QB_best)
summary(BetaGLM) #all Xs
BetaGLM2 = update(BetaGLM, . ~ . - fish_reg_total)
BetaGLM2 = update(BetaGLM, . ~ - fish_reg_total)
summary(BetaGLM2)
BetaGLM2 = update(BetaGLM, - fish_reg_total)
BetaGLM2 = update(BetaGLM, . - fish_reg_total)
BetaGLM2 = update(BetaGLM, . ~ - fish_reg_total)
summary(BetaGLM2)
BetaGLM2 = update(BetaGLM, . ~. - fish_reg_total)
BetaGLM2 = update(BetaGLM, . ~ . - fish_reg_total)
BetaGLM2 = update(BetaGLM, . ~ . -fish_reg_total)
BetaGLM2 = update(BetaGLM, .~. -fish_reg_total)
summary(BetaGLM2)
BetaGLM <- betareg(eco_sens ~ .,data=dat_select)
BetaGLM2 = update(BetaGLM, .~. -fish_reg_total)
BetaGLM2 = update(BetaGLM, formula= .~. -fish_reg_total)
head(dat_select)
BetaGLM2 = betareg(eco_sens ~ eez_percent_prot+coral_percent_prot+fish_reg_total+wgi_score,data=dat_select)
summary(BetaGLM2)
BetaGLM2 = betareg(eco_sens ~ eez_percent_prot+coral_percent_prot+wgi_score,data=dat_select)
summary(BetaGLM2)
BetaGLM3 = betareg(eco_sens ~ eez_percent_prot+coral_percent_prot,data=dat_select)
summary(BetaGLM2)
summary(BetaGLM3)
BetaGLM4 = betareg(eco_sens ~ eez_percent_prot,data=dat_select)
summary(BetaGLM4)
AIC(BetaGLM,BetaGLM2,BetaGLM3,BetaGLM4)
anova(BetaGLM,BetaGLM2,BetaGLM3,BetaGLM4)
BetaGLM <- betareg(eco_sens ~eez_percent_prot*coral_percent_prot*wgi_score*fish_reg_total,data=dat_select)
plot(BetaGLM) #all Xs included
summary(BetaGLM) #all Xs
BetaGLM <- betareg(eco_sens ~.,data=dat_select)
plot(BetaGLM) #all Xs included
plot(BetaGLM) #all Xs included
summary(BetaGLM) #all Xs
BetaGLM2 = betareg(eco_sens ~ eez_percent_prot*coral_percent_prot*wgi_score,data=dat_select)
```
anova(null,gaussian,LowestAIC,QB,QB_best,BetaGLM,BetaGLM3,test = "Chisq")
summary(BetaGLM3)
RsqGLM(BetaGLM3)
Dsquared(gaussian,family=gaussian)
gaussian$deviance # this is the explained deviance
Dsquared(gaussian,family=gaussian)
RsqGLM(gaussian) #This is an approximation for an Rsqard
Dsquared(gaussian,family=gaussian,adjust = TRUE)
summary(BetaGLM3)
summary(gaussian_best)
summary(QB_best)
drop1(QB)
QB_best$deviance # this is the explained deviance
RsqGLM(QB_best) #This is an approximation for an Rsqard
drop1(QB_best)
QB2=glm(eco_sens~ coral_percent_prot+wgi_score+fish_reg_total,data=dat_select,family=quasibinomial)
RsqGLM(QB2) #This is an approximation for an Rsqard
summary(QB2)
drop1(QB2)
summary(QB2)
pchisq(0.47595,QB_best$df.residual,lower.tail = FALSE)
pchisq(0.47595,QB2$df.residual,lower.tail = FALSE)
drop1(QB)
drop1(QB2)
QB3=glm(eco_sens~ coral_percent_prot+fish_reg_total,data=dat_select,family=quasibinomial)
QB2$deviance # this is the explained deviance
RsqGLM(QB2) #This is an approximation for an Rsqard
QB3$deviance # this is the explained deviance
RsqGLM(QB3) #This is an approximation for an Rsqard
summary(QB3)
drop1(gaussian)
gaussian2=glm(eco_sens~coral_percent_prot+fish_reg_total+wgi_score,data=dat_select,family=gaussian(link="identity"))
gaussian2$deviance # this is the explained deviance
RsqGLM(gaussian2) #This is an approximation for an Rsqard
summary(gaussian2) #summary of lowest AIC model
gaussian2$deviance # this is the explained deviance
drop1(gaussian2) # just a check to make sure you shouldn't remove any more
drop1(gaussian2) # just a check to make sure you shouldn't remove any more
gaussian3=glm(eco_sens~coral_percent_prot+wgi_score,data=dat_select,family=gaussian(link="identity"))
gaussian2$deviance # this is the explained deviance
RsqGLM(gaussian2) #This is an approximation for an Rsqard
plot(gaussian2) #plots for lowest AIC model
plot(gaussian2) #plots for lowest AIC model
summary(gaussian2) #summary of lowest AIC model
gaussian3=glm(eco_sens~coral_percent_prot+wgi_score,data=dat_select,family=gaussian(link="identity"))
gaussian2$deviance # this is the explained deviance
RsqGLM(gaussian2) #This is an approximation for an Rsqard
gaussian2$deviance # this is the explained deviance
gaussian2$deviance # this is the explained deviance
RsqGLM(gaussian2) #This is an approximation for an Rsqard
plot(gaussian2) #plots for lower AIC model
gaussian3$deviance # this is the explained deviance
RsqGLM(gaussian3) #This is an approximation for an Rsqard
plot(gaussian3) #plots for lower AIC model
summary(gaussian3) #summary of lowest AIC model
drop1(gaussian3) # just a check to make sure you shouldn't remove any more
anova(null,gaussian,gaussian2,gaussian3,test = "Chisq")  # an increase in deviance means a, a non-significant pvalue is a non-significant model
drop1(gaussian3) # just a check to make sure you shouldn't remove any more
anova(gaussian2,gaussian3,test = "Chisq")  # an increase in deviance means a, a non-significant pvalue is a non-significant model
gaussian3$deviance # this is the explained deviance
summary(gaussian3) #summary of lowest AIC model
summary(gaussian2) #summary of lowest AIC model
summary(gaussian) #all Xs included
drop1(gaussian)
gaussian2=glm(eco_sens~eez_percent_prot+coral_percent_prot+wgi_score,data=dat_select,family=gaussian(link="identity"))
gaussian2$deviance # this is the explained deviance
RsqGLM(gaussian2) #This is an approximation for an Rsqard
plot(gaussian2) #plots for lower AIC model
plot(gaussian2) #plots for lower AIC model
drop1(gaussian2) # just a check to make sure you shouldn't remove any more
gaussian3=glm(eco_sens~eez_percent_prot+coral_percent_prot,data=dat_select,family=gaussian(link="identity"))
gaussian3$deviance # this is the explained deviance
RsqGLM(gaussian3) #This is an approximation for an Rsqard
gaussian3=glm(eco_sens~coral_percent_prot+wgi_score,data=dat_select,family=gaussian(link="identity"))
gaussian3$deviance # this is the explained deviance
null=glm(eco_sens~1,data=dat_select,family=gaussian(link="identity"))
gaussian=glm(eco_sens ~ .,data=dat_select,family=gaussian(link="identity"))# Model with all Xs included
gaussian$deviance # this is the explained deviance
RsqGLM(gaussian) #This is an approximation for an Rsqard
vif(gaussian) # values for each variable closer to one indicate no multicolinaerity.  Higher values closer to 10 indicate the variable may be correlated with another explanatory variable.
plot(gaussian) #all Xs included
plot(gaussian) #all Xs included
summary(gaussian) #all Xs included
anova(null,gaussian,test = "Chisq")  # an increase in deviance means a, a non-significant pvalue is a non-significant model
drop1(gaussian)
gaussian2=glm(eco_sens~eez_percent_prot+coral_percent_prot+wgi_score,data=dat_select,family=gaussian(link="identity"))
gaussian2$deviance # this is the explained deviance
RsqGLM(gaussian2) #This is an approximation for an Rsqard
gaussian2=glm(eco_sens~fish_reg_total+coral_percent_prot+wgi_score,data=dat_select,family=gaussian(link="identity"))
gaussian2$deviance # this is the explained deviance
AIC(gaussian2)
gaussian2=glm(eco_sens~eez_percent_prot+coral_percent_prot+wgi_score,data=dat_select,family=gaussian(link="identity"))
gaussian2$deviance # this is the explained deviance
AIC(gaussian2)
RsqGLM(gaussian2) #This is an approximation for an Rsqard
plot(gaussian2) #plots for lower AIC model
drop1(gaussian2) # just a check to make sure you shouldn't remove any more
drop1(gaussian2,test="F") # just a check to make sure you shouldn't remove any more
drop1(gaussian,test="F")
null=glm(eco_sens~1,data=dat_select,family=gaussian(link="identity"))
gaussian=glm(eco_sens ~ .,data=dat_select,family=gaussian(link="identity"))# Model with all Xs included
gaussian$deviance # this is the explained deviance
RsqGLM(gaussian) #This is an approximation for an Rsqard
summary(gaussian) #all Xs included
anova(null,gaussian,test = "Chisq")  # an increase in residual deviance and a non-significant pvalue is a non-significant improvement
drop1(gaussian,test="F")
stepAIC(gaussian,direction = "both")
gaussian2=glm(eco_sens~eez_percent_prot+coral_percent_prot+wgi_score,data=dat_select,family=gaussian(link="identity"))
gaussian2$deviance # this is the explained deviance
RsqGLM(gaussian2) #This is an approximation for an Rsqard
plot(gaussian2) #plots for lower AIC model
summary(gaussian2) #summary of lowest AIC model
stepAIC(gaussian2) # just a check to make sure you shouldn't remove any more
stepAIC(gaussian,direction = "both")
gaussian3=glm(eco_sens~eez_percent_prot+coral_percent_prot,data=dat_select,family=gaussian(link="identity"))
gaussian3$deviance # this is the explained deviance
RsqGLM(gaussian3) #This is an approximation for an Rsqard
summary(gaussian3) #summary of lowest AIC model
drop1(gaussian3) # just a check to make sure you shouldn't remove any more
anova(null,gaussian,gaussian2,gaussian3,test = "Chisq")  # an increase in deviance means a, a non-significant pvalue is a non-significant model
anova(null,gaussian3,test = "Chisq")  # an increase in deviance means a, a non-significant pvalue is a non-significant model
gaussian_best=gaussian3
pchisq(0.073947,gaussian_best$df.residual,lower.tail = FALSE)
summary(gaussian_best)
cr.plots(gaussian_best)
QB=glm(eco_sens ~ .,data=dat_select,family=quasibinomial)# Model with all Xs included
QB$deviance # this is the explained deviance
RsqGLM(QB) #This is an approximation for an Rsqard
plot(QB) #all Xs included
plot(QB) #all Xs included
anova(null,gaussian,LowestAIC,QB,test = "Chisq")  # an increase in deviance means a non-significant model, a high pvalue is a non-significant model
anova(null,gaussian3,QB,test = "Chisq")  # an increase in deviance means a non-significant model, a high pvalue is a non-significant model
anova(null,gaussian_best,QB,test = "Chisq")  # an increase in deviance means a non-significant model, a high pvalue is a non-significant model
anova(null,gaussian_best,QB,test = "Chisq")  # an increase in deviance means a non-significant model, a high pvalue is a non-significant model
anova(null,QB,test = "Chisq")  # an increase in deviance means a non-significant model, a high pvalue is a non-significant model
stepAIC(QB)
QB=glm(eco_sens ~ .,data=dat_select,family=quasibinomial())# Model with all Xs included
QB$deviance # this is the explained deviance
stepAIC(QB)
step(QB)
AIC(QB)
BIC(QB)
gcv(QB)
drop1(QB)
drop1(QB)  ##have to do it this way rather than stepAIC because apparently AIC can't be calculated from a QB model.
?drop1
add1(QB)  ##have to do it this way rather than stepAIC because apparently AIC can't be calculated from a QB model.
drop1(QB)  ##have to do it this way rather than stepAIC because apparently AIC can't be calculated from a QB model.
QB2=glm(eco_sens~ coral_percent_prot+wgi_score+fish_reg_total,data=dat_select,family=quasibinomial)
QB2$deviance # this is the explained deviance
drop1(QB,test="F")  ##have to do it this way rather than stepAIC because apparently AIC can't be calculated from a QB model.
QB2=glm(eco_sens~ eez_percent_prot+coral_percent_prot+wgi_score,data=dat_select,family=quasibinomial)
QB2$deviance # this is the explained deviance
QB2=glm(eco_sens~coral_percent_prot+wgi_score+fish_reg_total,data=dat_select,family=quasibinomial)
QB2$deviance # this is the explained deviance
QB2=glm(eco_sens~coral_percent_prot+wgi_score+fish_reg_total,data=dat_select,family=quasibinomial)
QB2$deviance # this is the explained deviance
(eco_sens~coral_percent_prot+wgi_score+fish_reg_total,data=dat_select,family=quasibinomial)
RsqGLM(QB2) #This is an approximation for an Rsqard
summary(QB2)
QB=glm(eco_sens ~ .,data=dat_select,family=quasibinomial)# Model with all Xs included
QB$deviance # this is the explained deviance
RsqGLM(QB) #This is an approximation for an Rsqard
qAIC(QB)
deviance(QB)
deviance(gaussian,gaussian2)
deviance(gaussian)
deviance(gaussian2
)
deviance(gaussian3)
stepAIC(gaussian,direction = "both")
gaussian$deviance # this is the explained deviance
RsqGLM(gaussian) #This is an approximation for an Rsqard
plot(gaussian) #all Xs included
anova(null,gaussian,test = "Chisq")  # an increase in residual deviance and a non-significant pvalue is a non-significant improvement
stepAIC(gaussian,direction = "both")
drop1(gaussian)
deviance(glm(eco_sens~coral_percent_prot+fish_reg_total+wgi_score,data=dat_select,family=gaussian)
)
deviance(glm(eco_sens~coral_percent_prot+fish_reg_total+wgi_score,data=dat_select,family=gaussian(link="identity"))
)
AIC(glm(eco_sens~coral_percent_prot+fish_reg_total+wgi_score,data=dat_select,family=gaussian(link="identity"))
)
summary(glm(eco_sens~coral_percent_prot+fish_reg_total+wgi_score,data=dat_select,family=gaussian(link="identity"))
)
gaussian_best=gaussian3
summary(gaussian_best)
cr.plots(gaussian_best)
pchisq(0.058281,gaussian_best$df.residual,lower.tail = FALSE)
pchisq(0.085511-0.058281,gaussian_best$df.null-
gaussian_best$df.residual,lower.tail = FALSE)
summary(gaussian) #all Xs included
pchisq(0.085511-0.057259,gaussian$df.null-gaussian$df.residual,lower.tail = FALSE)
pchisq(0.085511-0.058281,gaussian_best$df.null-
gaussian_best$df.residual,lower.tail = FALSE)
summary(QB) #all Xs
pchisq(0.5526-0.37664,QB$df.null-QB$df.residual,lower.tail = FALSE)
drop1(QB,test="F")  ##have to do it this way rather than stepAIC because apparently AIC can't be calculated from a QB model.
drop1(QB)  ##have to do it this way rather than stepAIC because apparently AIC can't be calculated from a QB model.
QB2=glm(eco_sens~coral_percent_prot+wgi_score+fish_reg_total,data=dat_select,family=quasibinomial)
QB2$deviance # this is the explained deviance
RsqGLM(QB2) #This is an approximation for an Rsqard
summary(QB2)
deviance(QB2)
?deviance
deviance(gaussian)
deviance(null)-deviance(gaussian)/deviance(null)
deviance(gaussian)-deviance(null)/deviance(null)
summary.glm(QB) #all Xs
Dsquared(gaussian)
RsqGLM(gaussian) #This is an approximation for an Rsqard
?Dsquared
RsqGLM(gaussian) #This is an approximation for an Rsqard
Dsquared(gaussian2) # this is the explained deviance
Dsquared(gaussian3)# this is the explained deviance
RsqGLM(gaussian3) #This is an approximation for an Rsqard
drop1(gaussian3) # just a check to make sure you shouldn't remove any more
anova(null,gaussian,gaussian2,gaussian3,test = "Chisq")  # an increase in deviance means and a non-significant pvalue is a non-significant model
anova(null,gaussian)
anova(null,gaussian,gaussian2,gaussian3)  # an increase in deviance means and a non-significant pvalue is a non-significant model
anova(null,gaussian,gaussian2,gaussian3,test="F")  # an increase in deviance means and a non-significant pvalue is a non-significant model
anova(null,gaussian,gaussian2,gaussian3)  # an increase in deviance means and a non-significant pvalue is a non-significant model
anova(null,gaussian,gaussian2,gaussian3,test="Chisq")  # an increase in deviance means and a non-significant pvalue is a non-significant model
anova(null,gaussian,gaussian2,gaussian3)  # an increase in deviance means and a non-significant pvalue is a non-significant model
anova(null,gaussian,gaussian2,gaussian3)  # an increase in residual deviance and a non-significant pvalue is a non-significant improvement from the previous model
anova(null,gaussian,gaussian2,gaussian3,test="F")  # an increase in residual deviance and a non-significant pvalue is a non-significant improvement from the previous model
anova(null,gaussian,gaussian2,gaussian3,test="Chisq")  # an increase in residual deviance and a non-significant pvalue is a non-significant improvement from the previous model
gaussian_best=gaussian3
summary(gaussian_best)
Dsquared(gaussian3)# this is the explained deviance
Dsquared(gaussian2) # this is the explained deviance
Dsquared(gaussian)
Dsquared(gaussian3)# this is the explained deviance
summary(gaussian3) #summary of lowest AIC model
drop1(gaussian3) # just a check to make sure you shouldn't remove any more
anova(null,gaussian,gaussian2,gaussian3,test="Chisq")  # an increase in residual deviance and a non-significant pvalue is a non-significant improvement from the previous model
anova(null,gaussian3,test="Chisq")  # an increase in residual deviance and a non-significant pvalue is a non-significant improvement from the previous model
gaussian_best=gaussian3
summary(gaussian_best)
cr.plots(gaussian_best)
gaussian3=glm(eco_sens~eez_percent_prot,data=dat_select,family=gaussian(link="identity"))
Dsquared(gaussian3)# this is the explained deviance
1-pchisq(0.058281,gaussian_best$df.residual,lower.tail = FALSE)
pchisq(0.058281,gaussian_best$df.residual,lower.tail = FALSE)
QB=glm(eco_sens ~ .,data=dat_select,family=quasibinomial)# Model with all Xs included
deviance(QB)
Dsquared(QB)
RsqGLM(QB) #This is an approximation for an Rsqard
summary.glm(QB) #all Xs
pchisq(0.37664,QB$df.residual,lower.tail = FALSE)
drop1(QB)  ##have to do it this way rather than stepAIC because apparently AIC can't be calculated from a QB model.
QB2=glm(eco_sens~eez_percent_prot+coral_percent_prot+wgi_score,data=dat_select,family=quasibinomial)
deviance(QB2)
RsqGLM(QB2) #This is an approximation for an Rsqard
Dsquared(QB2)
RsqGLM(QB2) #This is an approximation for an Rsqard
summary(QB2)
anova(null,QB,QB2,test = "Chisq") # an increase in deviance means a non-significant model, a high pvalue is a non-significant model
anova(QB,QB2,test = "Chisq") # an increase in deviance means a non-significant model, a high pvalue is a non-significant model
summary(QB2)
pchisq(0.3767,QB2$df.residual,lower.tail = FALSE)
drop1(QB2)
QB3=glm(eco_sens~ eez_percent_prot+coral_percent_prot,data=dat_select,family=quasibinomial)
QB3$deviance # this is the explained deviance
Dsquared(QB3)
summary(QB3)
drop1(QB3)
BetaGLM <- betareg(eco_sens ~.,data=dat_select)
plot(BetaGLM) #all Xs included
plot(BetaGLM) #all Xs included
summary(BetaGLM) #all Xs
summary(QB3)
pchisq(0.3860,QB2$df.residual,lower.tail = FALSE)
anova(null,gaussian_best,QB_best,test = "Chisq") # an increase in deviance means a non-significant model, a high pvalue is a non-significant model
anova(gaussian_best,QB_best,test = "Chisq") # an increase in deviance means a non-significant model, a high pvalue is a non-significant model
anova(null,gaussian_best,QB_best,test = "Chisq") # an increase in deviance means a non-significant model, a high pvalue is a non-significant model
BetaGLM <- betareg(eco_sens ~.,data=dat_select)
plot(BetaGLM) #all Xs included
summary(BetaGLM) #all Xs
anova(null,gaussian_best,QB_best,BetaGLM,test = "Chisq")  # an increase in deviance means a non-significant model, a high pvalue is a non-significant model
BetaGLM <- betareg(eco_sens ~.,data=dat_select)
plot(BetaGLM) #all Xs included
summary(BetaGLM) #all Xs
anova(null,gaussian_best,QB_best,BetaGLM,test = "Chisq")  # an increase in deviance means a non-significant model, a high pvalue is a non-significant model
BetaGLM2 = betareg(eco_sens ~ eez_percent_prot+coral_percent_prot+wgi_score,data=dat_select)
BetaGLM2 = betareg(eco_sens ~ eez_percent_prot+coral_percent_prot+wgi_score,data=dat_select)
summary(BetaGLM2)
summary(BetaGLM) #all Xs
BetaGLM2 = betareg(eco_sens ~ eez_percent_prot+coral_percent_prot+wgi_score,data=dat_select)
summary(BetaGLM2)
BetaGLM3 = betareg(eco_sens ~ eez_percent_prot+coral_percent_prot,data=dat_select)
summary(BetaGLM3) # best beta GLM
BetaGLM4 = betareg(eco_sens ~ eez_percent_prot,data=dat_select)
summary(BetaGLM4)
summary(BetaGLM3) # best beta GLM
AIC(BetaGLM,BetaGLM2,BetaGLM3,BetaGLM4)
Beta_best=BetaGLM3
anova(null,gaussian_best,QB,QB_best,Beta_best,test = "Chisq")
anova(null,gaussian_best,QB,QB_best,Beta_best,test = "Chisq")
anova(null,gaussian_best,QB_best,Beta_best,test = "Chisq")
BetaGLM3 = betareg(eco_sens ~ eez_percent_prot+coral_percent_prot,data=dat_select)
summary(BetaGLM3) # best beta GLM
BetaGLM4 = betareg(eco_sens ~ eez_percent_prot,data=dat_select)
summary(BetaGLM4)
anova(null,gaussian_best,QB_best,Beta_best,test = "Chisq")
anova(QB_best,Beta_best,test = "Chisq")
QB_best=QB3
anova(null,gaussian_best,QB_best,test = "Chisq") # an increase in deviance means a non-significant model, a high pvalue is a non-significant model
anova(QB_best,Beta_best,test = "Chisq")
anova(null,QB_best,Beta_best,test = "Chisq")
Dsquared(Beta_best)
Beta_best$pseudo.r.squared
RsqGLM(QB_best) #This is an approximation for an Rsqard
Beta_best$pseudo.r.squared
RsqGLM(QB_best)
crplots(Beta_best)
cr.plots(Beta_best)
plot(Beta_best)
?betareg
summary(QB3)
?RsqGLM
Beta_best$pseudo.r.squared
RsqGLM(gaussian_best) #This is an approximation for an Rsqard
RsqGLM(QB_best) #This is an approximation for an Rsqard
