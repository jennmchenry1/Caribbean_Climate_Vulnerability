---
title: "GLM of SEV scores"
author: "Jenn_McHenry"
date: "November 14, 2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(MASS)
library(car)
library(modEvA)
```

# Initial examination of x and y parameters
```{r cars}
dat=read.csv("vulnerability_covariates.csv")

# head(dat)
# 
# summary(dat)

```

## Ecological Sensitivity

```{r Ecologial Sensitivity, echo=TRUE}
dat_select_es<-dat %>%
  na.omit()%>%
  dplyr::select(eco_sens,eez_percent_prot,coral_percent_prot,
                fish_reg_total,wgi_score)

results_es=glm(eco_sens ~ .,data=dat_select_es)# Model with all Xs included
Dsquared(results_es)  # explained deviance with all Xs included

### check for assumptions of GLMs
par(mfrow = c(2,2))
plot(results_es) #all Xs included -- doesn't look good
summary(results_es) #all Xs included

#stepwise backward removal and addition of variables
stepAIC(results_es,direction = "both")

#lowest AIC model that isn't the null model
LowestAIC_es=glm(eco_sens~eez_percent_prot + coral_percent_prot,data=dat_select_es)
Dsquared(LowestAIC_es)  # explained deviance for best fit model

par(mfrow = c(2,2))
plot(LowestAIC_es) #best fit model 
summary(LowestAIC_es) #best fit model 

```


## Ecological Recovery

```{r Ecologial Recovery, echo=TRUE}
dat_select_erp<-dat %>%
  na.omit()%>%
  dplyr::select(eco_recov,eez_percent_prot,coral_percent_prot,fish_reg_total,wgi_score)

results_erp=glm(eco_recov ~ .,data=dat_select_erp)# Model with all Xs included
Dsquared(results_erp)  # explained deviance with all Xs included

### check for assumptions of GLMs
par(mfrow = c(2,2))
plot(results_erp) #all Xs included
summary(results_erp) #all Xs included

#stepwise backward removal and addition of variables
stepAIC(results_erp,direction = "both")

#lowest AIC model that isn't the null model
LowestAIC_erp=glm(eco_recov~wgi_score,data=dat_select_erp)
Dsquared(LowestAIC_erp)  # explained deviance for best fit model 

### check for assumptions of GLMs
par(mfrow = c(2,2))
plot(LowestAIC_erp) #best fit model 
summary(LowestAIC_erp) #best fit model 

```


## Ecological Vulnerability/Socioeconomic Exposure

```{r Ecologial Vulnerability, echo=TRUE}
dat_select_se<-dat %>%
  na.omit()%>%
  dplyr::select(eco_vul,eez_percent_prot,coral_percent_prot,fish_reg_total,wgi_score)

results_se=glm(eco_vul~ .,data=dat_select_se)# Model with all Xs included
Dsquared(results_se)  # explained deviance with all Xs included

### check for assumptions of GLMs
par(mfrow = c(2,2))
plot(results_se) #all Xs included
summary(results_se) #all Xs included

#stepwise backward removal and addition of variables
stepAIC(results_se,direction = "both")

#lowest AIC model that isn't the null model
LowestAIC_se=glm(eco_vul~eez_percent_prot,data=dat_select_se)
Dsquared(LowestAIC_se)  # explained deviance for best fit model 

### check for assumptions of GLMs
par(mfrow = c(2,2))
plot(LowestAIC_se) #best fit model 
summary(LowestAIC_se) #best fit model 

```


## Social Sensitivity

```{r Social Sensitivity, echo=TRUE}
dat_select_ss<-dat %>%
  na.omit()%>%
  dplyr::select(soc_sen,eez_percent_prot,coral_percent_prot,fish_reg_total,wgi_score)

results_ss=glm(soc_sen~ .,data=dat_select_ss)# Model with all Xs included
Dsquared(results_ss)  # explained deviance with all Xs included

### check for assumptions of GLMs
par(mfrow = c(2,2))
plot(results_ss) #all Xs included
summary(results_ss) #all Xs included

#stepwise backward removal and addition of variables
stepAIC(results_ss,direction = "both")

#lowest AIC model that isn't the null model
LowestAIC_ss=glm(soc_sen~wgi_score,data=dat_select_ss)
Dsquared(LowestAIC_ss)  # explained deviance for best fit model 
plot(LowestAIC_ss) #best fit model 
summary(LowestAIC_ss) #best fit model 
```

## Social Adaptive Capacity

```{r Social Adaptive Capacity, echo=TRUE}
dat_select_sac<-dat %>%
  na.omit()%>%
  dplyr::select(soc_ac,eez_percent_prot,coral_percent_prot,fish_reg_total,wgi_score)

results_sac=glm(soc_ac~ .,data=dat_select_sac)# Model with all Xs included
Dsquared(results_sac)  # explained deviance with all Xs included

### check for assumptions of GLMs
par(mfrow = c(2,2))
plot(results_sac) #all Xs included
summary(results_sac) #all Xs included

#stepwise backward removal and addition of variables
stepAIC(results_sac,direction = "both")

#lowest AIC model that isn't the null model
LowestAIC_sac=glm(soc_ac~fish_reg_total,data=dat_select_sac)
Dsquared(LowestAIC_sac)  # explained deviance for best fit model 

### check for assumptions of GLMs
par(mfrow = c(2,2))
plot(LowestAIC_sac) #best fit model 
summary(LowestAIC_sac) #best fit model 
```



## Social Vulnerability

```{r Social , echo=TRUE}
dat_select_sev<-dat %>%
  na.omit()%>%
  dplyr::select(se_vul,eez_percent_prot,coral_percent_prot,fish_reg_total,wgi_score)

results_sev=glm(se_vul~ .,data=dat_select_sev)# Model with all Xs included
Dsquared(results_sev)  # explained deviance with all Xs included

### check for assumptions of GLMs
par(mfrow = c(2,2))
plot(results_sev) #all Xs included
summary(results_sev) #all Xs 



#stepwise backward removal and addition of variables
stepAIC(results_sev,direction = "both")

#lowest AIC model that isn't the null model
LowestAIC_sev=glm(se_vul~fish_reg_total,data=dat_select_sev)
Dsquared(LowestAIC_sev)  # explained deviance for best fit model 

### check for assumptions of GLMs
par(mfrow = c(2,2))
plot(LowestAIC_sev) #best fit model 
summary(LowestAIC_sev) #best fit model 

```