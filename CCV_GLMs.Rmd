---
title: "GLM of SEV scores"
author: "Jenn_McHenry"
date: "November 14, 2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

```

# Initial examination of x and y parameters
```{r cars}
dat=read.csv("vulnerability_covariates.csv")

head(dat)

summary(dat)

```

## Ecological Exposure

```{r Ecologial Exposure, echo=TRUE}
library(dplyr)
library(MASS)
library(car)
library(modEvA)

head(dat)
dat_select<-dat %>%
  na.omit()%>%
  dplyr::select(eco_exp,eez_percent_prot,coral_percent_prot,fish_reg_total,wgi_score)

results=glm(eco_exp ~ .,data=dat_select) # Model with all Xs included
Dsquared(results)  # explained deviance with all Xs included
plot(results) #all Xs included
summary(results) #all Xs included


#stepwise backward removal and addition of variables
stepAIC(results,direction = "both")

#lowest AIC model that isn't the null model
LowestAIC=glm(eco_exp~wgi_score,data=dat_select)
Dsquared(LowestAIC)  # explained deviance with all Xs included
plot(LowestAIC) #all Xs included
summary(LowestAIC) #all Xs included

```


## Ecological Sensitivity

```{r Ecologial Sensitivity, echo=TRUE}
library(dplyr)
library(MASS)
library(car)
library(modEvA)

head(dat)
dat_select<-dat %>%
  na.omit()%>%
  dplyr::select(eco_sens,eez_percent_prot,coral_percent_prot,fish_reg_total,wgi_score)

results=glm(eco_sens ~ .,data=dat_select)# Model with all Xs included
Dsquared(results)  # explained deviance with all Xs included
plot(results) #all Xs included
summary(results) #all Xs included

#stepwise backward removal and addition of variables
stepAIC(results,direction = "both")

#lowest AIC model that isn't the null model
LowestAIC=glm(eco_sens~eez_percent_prot + coral_percent_prot,data=dat_select)
Dsquared(LowestAIC)  # explained deviance with all Xs included
plot(LowestAIC) #all Xs included
summary(LowestAIC) #all Xs included

```


## Ecological Recovery

```{r Ecologial Recovery, echo=TRUE}
library(dplyr)
library(MASS)
library(car)
library(modEvA)

head(dat)
dat_select<-dat %>%
  na.omit()%>%
  dplyr::select(eco_recov,eez_percent_prot,coral_percent_prot,fish_reg_total,wgi_score)

results=glm(eco_recov ~ .,data=dat_select)# Model with all Xs included
Dsquared(results)  # explained deviance with all Xs included
plot(results) #all Xs included
summary(results) #all Xs included

#stepwise backward removal and addition of variables
stepAIC(results,direction = "both")

#lowest AIC model that isn't the null model
LowestAIC=glm(eco_recov~wgi_score,data=dat_select)
Dsquared(LowestAIC)  # explained deviance with all Xs included
plot(LowestAIC) #all Xs included
summary(LowestAIC) #all Xs included

```


## Ecological Vulnerability

```{r Ecologial Vulnerability, echo=TRUE}
library(dplyr)
library(MASS)
library(car)
library(modEvA)

head(dat)
dat_select<-dat %>%
  na.omit()%>%
  dplyr::select(eco_vul,eez_percent_prot,coral_percent_prot,fish_reg_total,wgi_score)

results=glm(eco_vul~ .,data=dat_select)# Model with all Xs included
Dsquared(results)  # explained deviance with all Xs included
plot(results) #all Xs included
summary(results) #all Xs included

#stepwise backward removal and addition of variables
stepAIC(results,direction = "both")

#lowest AIC model that isn't the null model
LowestAIC=glm(eco_vul~eez_percent_prot,data=dat_select)
Dsquared(LowestAIC)  # explained deviance with all Xs included
plot(LowestAIC) #all Xs included
summary(LowestAIC) #all Xs included

```


## Social Sensitivity

```{r Social Sensitivity, echo=TRUE}
library(dplyr)
library(MASS)
library(car)
library(modEvA)

head(dat)
dat_select<-dat %>%
  na.omit()%>%
  dplyr::select(soc_sen,eez_percent_prot,coral_percent_prot,fish_reg_total,wgi_score)

results=glm(soc_sen~ .,data=dat_select)# Model with all Xs included
Dsquared(results)  # explained deviance with all Xs included
plot(results) #all Xs included
summary(results) #all Xs included

#stepwise backward removal and addition of variables
stepAIC(results,direction = "both")

#lowest AIC model that isn't the null model
LowestAIC=glm(soc_sen~wgi_score,data=dat_select)
Dsquared(LowestAIC)  # explained deviance with all Xs included
plot(LowestAIC) #all Xs included
summary(LowestAIC) #all Xs included
```

## Social Adaptive Capacity

```{r Social Adaptive Capacity, echo=TRUE}
library(dplyr)
library(MASS)
library(car)
library(modEvA)

head(dat)
dat_select<-dat %>%
  na.omit()%>%
  dplyr::select(soc_ac,eez_percent_prot,coral_percent_prot,fish_reg_total,wgi_score)

results=glm(soc_ac~ .,data=dat_select)# Model with all Xs included
Dsquared(results)  # explained deviance with all Xs included
plot(results) #all Xs included
summary(results) #all Xs included

#stepwise backward removal and addition of variables
stepAIC(results,direction = "both")

#lowest AIC model that isn't the null model
LowestAIC=glm(soc_ac~fish_reg_total,data=dat_select)
Dsquared(LowestAIC)  # explained deviance with all Xs included
plot(LowestAIC) #all Xs included
summary(LowestAIC) #all Xs included
```



## Social Vulnerability

```{r Social , echo=TRUE}
library(dplyr)
library(MASS)
library(car)
library(modEvA)

head(dat)
dat_select<-dat %>%
  na.omit()%>%
  dplyr::select(se_vul,eez_percent_prot,coral_percent_prot,fish_reg_total,wgi_score)

results=glm(se_vul~ .,data=dat_select)# Model with all Xs included
Dsquared(results)  # explained deviance with all Xs included
plot(results) #all Xs included
summary(results) #all Xs 



#stepwise backward removal and addition of variables
stepAIC(results,direction = "both")

#lowest AIC model that isn't the null model
LowestAIC=glm(se_vul~fish_reg_total,data=dat_select)
Dsquared(LowestAIC)  # explained deviance with all Xs included
plot(LowestAIC) #all Xs included
summary(LowestAIC) #all Xs included

```