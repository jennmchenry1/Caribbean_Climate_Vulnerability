---
title: "GLM of SEV scores"
author: "Jenn_McHenry"
date: "November 14, 2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Setting directories
```{r}
primary_dir=paste("C:/Users/jennm/Dropbox/PROJECTS/SocioEcological_Vulnerability_of_Caribbean/SEV_IndexGLM",sep="")

```

## Loading in libraries

```{r}
library(dplyr)
library(MASS)
```
## Initial examination of x and y parameters

```{r cars}
dat=read.csv("vulnerability_covariates.csv")

head(dat)

summary(dat)

```

## Ecological Exposure

```{r Ecologial Exposure, echo=FALSE}
dat_select<-dat %>%
  na.omit()%>%
  dplyr::select(eco_exp,eez_percent_prot,coral_percent_prot,fish_reg_total,wgi_score)

results=glm(eco_exp ~ .,data=dat_select,family= binomial)
summary(results)
stepAIC(results,direction = "both")



```


## Ecological Sensitivity

```{r Ecologial Sensitivity, echo=FALSE}
head(dat)
dat_select<-dat %>%
  na.omit()%>%
  dplyr::select(eco_sens,eez_percent_prot,coral_percent_prot,fish_reg_total,wgi_score)

results=glm(eco_sens ~ .,data=dat_select)
summary(results)
stepAIC(results,direction = "both")

```


## Ecological Recovery

```{r Ecologial Recovery, echo=FALSE}
head(dat)
dat_select<-dat %>%
  na.omit()%>%
  dplyr::select(eco_recov,eez_percent_prot,coral_percent_prot,fish_reg_total,wgi_score)

results=glm(eco_recov ~ .,data=dat_select)
summary(results)
stepAIC(results,direction = "both")

```


## Ecological Vulnerability

```{r Ecologial Vulnerability, echo=FALSE}
head(dat)
dat_select<-dat %>%
  na.omit()%>%
  dplyr::select(eco_vul,eez_percent_prot,coral_percent_prot,fish_reg_total,wgi_score)

results=glm(eco_vul~ .,data=dat_select)
summary(results)
stepAIC(results,direction = "both")

```


## Social Sensitivity

```{r Social Sensitivity, echo=FALSE}
head(dat)
dat_select<-dat %>%
  na.omit()%>%
  dplyr::select(soc_sen,eez_percent_prot,coral_percent_prot,fish_reg_total,wgi_score)

results=glm(soc_sen~ .,data=dat_select)
summary(results)
stepAIC(results,direction = "both")
```

## Social Adaptive Capacity

```{r Social Adaptive Capacity, echo=FALSE}
head(dat)
dat_select<-dat %>%
  na.omit()%>%
  dplyr::select(soc_ac,eez_percent_prot,coral_percent_prot,fish_reg_total,wgi_score)

results=glm(soc_ac~ .,data=dat_select)
summary(results)
stepAIC(results,direction = "both")
```



## Social Vulnerability

```{r Social , echo=FALSE}
head(dat)
dat_select<-dat %>%
  na.omit()%>%
  dplyr::select(se_vul,eez_percent_prot,coral_percent_prot,fish_reg_total,wgi_score)

results=glm(se_vul~ .,data=dat_select)
summary(results)
stepAIC(results,direction = "both")

summary(glm(se_vul~fish_reg_total+eez_percent_prot+wgi_score,data=dat_select))
```